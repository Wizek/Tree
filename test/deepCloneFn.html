<!DOCTYPE html>
<script>

var oldFn = (function() {
  function instance () {
    var oldFn = function() {
      console.log('Main old fn called')
    }
    oldFn.foo = 123
    oldFn.newInstance = function() {
      return new instance()
    }
    oldFn.bar = function() {
      console.log(this.bar.baz)
    } 
    oldFn.bar.baz = 'another property'
    return oldFn
  }
  return new instance()
})()

newerFn = oldFn.newInstance()

console.log(newerFn, oldFn)
console.log(newerFn.foo, oldFn.foo)
newerFn.foo = "changed"
var newestFn =  newerFn.newInstance()
console.log(newestFn.foo, newerFn.foo, oldFn.foo)
console.log(oldFn.bar.baz)
console.log(newerFn.bar.baz)

oldFn.bar()
newerFn.bar()

/*
function deepClone (input) {
  var type = typeof input
  var result
  if (type == 'undefined') {
    // do not copy anything then...
  } else if ( // safe, will copy by value
      type == 'string' ||
      type == 'number' ||
      type == 'boolean' ||
      input === null
    ) {
    result = input
  } else if (Array.isArray(input)) {
    result = []
    for (var i = 0; i < input.length; i++) {
      result[i] = arguments.callee(input[i])
    }
  } else if (type == 'object') {
    result = {}
    for (key in input) if (input.hasOwnProperty(key)) {
      result[key] = arguments.callee(input[key])
    }
  } else if (type == 'function') {
    result = input.bind()
    for (key in input) if (input.hasOwnProperty(key)) {
      result[key] = arguments.callee(input[key])
    }
  } else {
    console.error('What did we miss out?')
  }
  return result
}
*/
</script>